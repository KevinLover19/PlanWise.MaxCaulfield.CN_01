<?php
// PlanWise - åˆ›å»ºæŠ¥å‘Šé¡µé¢
require_once __DIR__ . '/db_connect.php';
session_start();

// æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²ç™»å½•
if (!is_logged_in()) {
    header('Location: /login.php');
    exit();
}

// è®¾ç½®é¡µé¢ç‰¹å®šçš„å˜é‡
$page_title = "åˆ›å»ºå•†ä¸šç­–ç•¥åˆ†ææŠ¥å‘Š";
$page_description = "ä½¿ç”¨PlanWise AIåˆ›å»ºè¯¦ç»†çš„å•†ä¸šç­–ç•¥åˆ†ææŠ¥å‘Š - å¸‚åœºåˆ†æã€ç«äº‰å¯¹æ‰‹ç ”ç©¶ã€è´¢åŠ¡é¢„æµ‹ç­‰8ä¸ªç»´åº¦çš„ä¸“ä¸šåˆ†æ";
$canonical_url = "https://planwise.maxcaulfield.cn/report.php";

// è®¾ç½®é¢åŒ…å±‘å¯¼èˆª
$breadcrumbs = [
    '/dashboard.php' => 'æˆ‘çš„æ§åˆ¶å°',
    'åˆ›å»ºæŠ¥å‘Š'
];

// åŒ…å«å¤´éƒ¨
include __DIR__ . '/includes/header.php';
?>

<!-- æŠ¥å‘Šåˆ›å»ºè¡¨å• -->
<section class="py-12 min-h-screen" style="background-color: var(--sky-dark);">
    <div class="container mx-auto px-6">
        <div class="max-w-4xl mx-auto">
            <!-- é¡µé¢æ ‡é¢˜ -->
            <div class="text-center mb-12">
                <h1 class="text-4xl font-bold text-white mb-6">
                    åˆ›å»ºå•†ä¸šç­–ç•¥åˆ†ææŠ¥å‘Š
                </h1>
                <p class="text-xl text-gray-300 max-w-3xl mx-auto">
                    å‘Šè¯‰æˆ‘ä»¬æ‚¨çš„å•†ä¸šæƒ³æ³•ï¼ŒAIå°†ä¸ºæ‚¨ç”ŸæˆåŒ…å«å¸‚åœºåˆ†æã€ç«äº‰ç ”ç©¶ã€è´¢åŠ¡é¢„æµ‹ç­‰8ä¸ªç»´åº¦çš„ä¸“ä¸šæŠ¥å‘Š
                </p>
            </div>
            
            <!-- æŠ¥å‘Šç”Ÿæˆè¡¨å• -->
            <div class="dashboard-card reveal p-8 rounded-xl">
                <form id="report-form" method="post" action="/api.php">
                    <input type="hidden" name="action" value="create_report">
                    
                    <!-- åŸºæœ¬ä¿¡æ¯ -->
                    <div class="mb-8">
                        <h2 class="text-2xl font-semibold text-white mb-6 flex items-center">
                            <i class="fas fa-lightbulb mr-3 text-blue-400"></i>
                            å•†ä¸šæƒ³æ³•æè¿°
                        </h2>
                        
                        <div class="mb-6">
                            <label for="business_title" class="block text-gray-300 font-medium mb-2">
                                é¡¹ç›®æ ‡é¢˜ <span class="text-red-400">*</span>
                            </label>
                            <input 
                                type="text" 
                                id="business_title" 
                                name="business_title" 
                                required
                                class="w-full px-4 py-3 bg-gray-800 bg-opacity-50 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:border-blue-400 focus:outline-none transition"
                                placeholder="ä¾‹å¦‚ï¼šæ™ºèƒ½å¥åº·ç›‘æµ‹æ‰‹ç¯"
                                maxlength="100"
                            >
                        </div>
                        
                        <div class="mb-6">
                            <label for="business_description" class="block text-gray-300 font-medium mb-2">
                                è¯¦ç»†æè¿° <span class="text-red-400">*</span>
                            </label>
                            <textarea 
                                id="business_description" 
                                name="business_description" 
                                required
                                rows="6"
                                class="w-full px-4 py-3 bg-gray-800 bg-opacity-50 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:border-blue-400 focus:outline-none transition resize-y"
                                placeholder="è¯¦ç»†æè¿°æ‚¨çš„å•†ä¸šæƒ³æ³•ï¼ŒåŒ…æ‹¬äº§å“/æœåŠ¡æ¦‚å¿µã€ç›®æ ‡ç”¨æˆ·ã€æ ¸å¿ƒåŠŸèƒ½ã€é¢„æœŸå¸‚åœºç­‰ã€‚æè¿°è¶Šè¯¦ç»†ï¼ŒAIåˆ†æè¶Šç²¾å‡†..."
                                minlength="50"
                                maxlength="2000"
                            ></textarea>
                            <div class="flex justify-between items-center mt-2">
                                <p class="text-gray-400 text-sm">
                                    ğŸ’¡ å»ºè®®è‡³å°‘50å­—ï¼Œæœ€å¤š2000å­—
                                </p>
                                <span id="char-count" class="text-gray-400 text-sm">0/2000</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- åˆ†æé€‰é¡¹ -->
                    <div class="mb-8">
                        <h2 class="text-2xl font-semibold text-white mb-6 flex items-center">
                            <i class="fas fa-cogs mr-3 text-purple-400"></i>
                            åˆ†æé€‰é¡¹
                        </h2>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <!-- åˆ†ææ·±åº¦ -->
                            <div>
                                <label class="block text-gray-300 font-medium mb-3">åˆ†ææ·±åº¦</label>
                                <div class="space-y-3">
                                    <label class="flex items-center p-3 bg-gray-800 bg-opacity-30 rounded-lg cursor-pointer hover:bg-opacity-50 transition">
                                        <input type="radio" name="analysis_depth" value="basic" checked class="mr-3 text-blue-500">
                                        <div class="flex-1">
                                            <div class="flex items-center justify-between">
                                                <span class="text-white font-medium">åŸºç¡€ç‰ˆ</span>
                                                <span class="text-green-400 text-sm">å…è´¹</span>
                                            </div>
                                            <p class="text-gray-400 text-sm mt-1">çº¦5-8åˆ†é’Ÿ | æ ¸å¿ƒåˆ†æè¦ç‚¹</p>
                                        </div>
                                    </label>
                                    
                                    <label class="flex items-center p-3 bg-gray-800 bg-opacity-30 rounded-lg cursor-pointer hover:bg-opacity-50 transition">
                                        <input type="radio" name="analysis_depth" value="standard" class="mr-3 text-blue-500">
                                        <div class="flex-1">
                                            <div class="flex items-center justify-between">
                                                <span class="text-white font-medium">æ ‡å‡†ç‰ˆ</span>
                                                <span class="text-blue-400 text-sm">æ¨è</span>
                                            </div>
                                            <p class="text-gray-400 text-sm mt-1">çº¦12-15åˆ†é’Ÿ | è¯¦ç»†åˆ†ææŠ¥å‘Š</p>
                                        </div>
                                    </label>
                                </div>
                            </div>
                            
                            <!-- è¡Œä¸šç±»å‹ -->
                            <div>
                                <label for="industry" class="block text-gray-300 font-medium mb-3">è¡Œä¸šç±»å‹</label>
                                <select 
                                    id="industry" 
                                    name="industry"
                                    class="w-full px-4 py-3 bg-gray-800 bg-opacity-50 border border-gray-600 rounded-lg text-white focus:border-blue-400 focus:outline-none transition"
                                >
                                    <option value="">è¯·é€‰æ‹©è¡Œä¸šï¼ˆå¯é€‰ï¼‰</option>
                                    <option value="technology">ç§‘æŠ€äº’è”ç½‘</option>
                                    <option value="ecommerce">ç”µå­å•†åŠ¡</option>
                                    <option value="healthcare">åŒ»ç–—å¥åº·</option>
                                    <option value="education">æ•™è‚²åŸ¹è®­</option>
                                    <option value="finance">é‡‘èæœåŠ¡</option>
                                    <option value="retail">é›¶å”®æ¶ˆè´¹</option>
                                    <option value="manufacturing">åˆ¶é€ ä¸š</option>
                                    <option value="service">æœåŠ¡ä¸š</option>
                                    <option value="other">å…¶ä»–</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <!-- é‡ç‚¹å…³æ³¨ -->
                    <div class="mb-8">
                        <h2 class="text-2xl font-semibold text-white mb-6 flex items-center">
                            <i class="fas fa-bullseye mr-3 text-orange-400"></i>
                            é‡ç‚¹å…³æ³¨é¢†åŸŸ
                        </h2>
                        <p class="text-gray-400 mb-4">é€‰æ‹©æ‚¨æœ€å…³æ³¨çš„åˆ†æç»´åº¦ï¼ˆå¯å¤šé€‰ï¼Œä¸é€‰æ‹©åˆ™å…¨éƒ¨åˆ†æï¼‰</p>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                            <label class="flex items-center p-3 bg-gray-800 bg-opacity-30 rounded-lg cursor-pointer hover:bg-opacity-50 transition">
                                <input type="checkbox" name="focus_areas[]" value="market" class="mr-3 text-blue-500">
                                <i class="fas fa-chart-line mr-2 text-blue-400"></i>
                                <span class="text-white">å¸‚åœºç¯å¢ƒåˆ†æ</span>
                            </label>
                            
                            <label class="flex items-center p-3 bg-gray-800 bg-opacity-30 rounded-lg cursor-pointer hover:bg-opacity-50 transition">
                                <input type="checkbox" name="focus_areas[]" value="competition" class="mr-3 text-blue-500">
                                <i class="fas fa-crosshairs mr-2 text-red-400"></i>
                                <span class="text-white">ç«äº‰å¯¹æ‰‹ç ”ç©¶</span>
                            </label>
                            
                            <label class="flex items-center p-3 bg-gray-800 bg-opacity-30 rounded-lg cursor-pointer hover:bg-opacity-50 transition">
                                <input type="checkbox" name="focus_areas[]" value="users" class="mr-3 text-blue-500">
                                <i class="fas fa-users mr-2 text-purple-400"></i>
                                <span class="text-white">ç›®æ ‡ç”¨æˆ·ç”»åƒ</span>
                            </label>
                            
                            <label class="flex items-center p-3 bg-gray-800 bg-opacity-30 rounded-lg cursor-pointer hover:bg-opacity-50 transition">
                                <input type="checkbox" name="focus_areas[]" value="business_model" class="mr-3 text-blue-500">
                                <i class="fas fa-building mr-2 text-green-400"></i>
                                <span class="text-white">å•†ä¸šæ¨¡å¼è®¾è®¡</span>
                            </label>
                            
                            <label class="flex items-center p-3 bg-gray-800 bg-opacity-30 rounded-lg cursor-pointer hover:bg-opacity-50 transition">
                                <input type="checkbox" name="focus_areas[]" value="finance" class="mr-3 text-blue-500">
                                <i class="fas fa-dollar-sign mr-2 text-yellow-400"></i>
                                <span class="text-white">è´¢åŠ¡é¢„æµ‹</span>
                            </label>
                            
                            <label class="flex items-center p-3 bg-gray-800 bg-opacity-30 rounded-lg cursor-pointer hover:bg-opacity-50 transition">
                                <input type="checkbox" name="focus_areas[]" value="risk" class="mr-3 text-blue-500">
                                <i class="fas fa-shield-alt mr-2 text-orange-400"></i>
                                <span class="text-white">é£é™©è¯„ä¼°</span>
                            </label>
                            
                            <label class="flex items-center p-3 bg-gray-800 bg-opacity-30 rounded-lg cursor-pointer hover:bg-opacity-50 transition">
                                <input type="checkbox" name="focus_areas[]" value="marketing" class="mr-3 text-blue-500">
                                <i class="fas fa-bullhorn mr-2 text-pink-400"></i>
                                <span class="text-white">è¥é”€ç­–ç•¥</span>
                            </label>
                            
                            <label class="flex items-center p-3 bg-gray-800 bg-opacity-30 rounded-lg cursor-pointer hover:bg-opacity-50 transition">
                                <input type="checkbox" name="focus_areas[]" value="implementation" class="mr-3 text-blue-500">
                                <i class="fas fa-route mr-2 text-cyan-400"></i>
                                <span class="text-white">å®æ–½è·¯çº¿å›¾</span>
                            </label>
                        </div>
                    </div>
                    
                    <!-- æäº¤æŒ‰é’® -->
                    <div class="text-center">
                        <button 
                            type="submit" 
                            id="submit-btn"
                            class="cta-button text-lg px-10 py-4 disabled:opacity-50 disabled:cursor-not-allowed"
                        >
                            <i class="fas fa-rocket mr-2"></i>
                            å¼€å§‹ç”ŸæˆæŠ¥å‘Š
                        </button>
                        
                        <p class="text-gray-400 text-sm mt-4">
                            ğŸ’¡ ç‚¹å‡»åå°†è·³è½¬åˆ°ç”Ÿæˆé¡µé¢ï¼Œæ‚¨å¯ä»¥å®æ—¶æŸ¥çœ‹AIçš„åˆ†æè¿‡ç¨‹
                        </p>
                    </div>
                </form>
            </div>
            
            <!-- åŠŸèƒ½è¯´æ˜ -->
            <div class="mt-12">
                <div class="dashboard-card reveal p-6 rounded-xl">
                    <h3 class="text-lg font-semibold text-white mb-4 flex items-center">
                        <i class="fas fa-info-circle mr-2 text-blue-400"></i>
                        æŠ¥å‘Šå°†åŒ…å«ä»¥ä¸‹å†…å®¹
                    </h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-gray-300">
                        <div class="flex items-center">
                            <i class="fas fa-check-circle mr-2 text-green-400"></i>
                            <span>å¸‚åœºç¯å¢ƒä¸æœºä¼šåˆ†æ</span>
                        </div>
                        <div class="flex items-center">
                            <i class="fas fa-check-circle mr-2 text-green-400"></i>
                            <span>ä¸»è¦ç«äº‰å¯¹æ‰‹ç ”ç©¶</span>
                        </div>
                        <div class="flex items-center">
                            <i class="fas fa-check-circle mr-2 text-green-400"></i>
                            <span>ç›®æ ‡ç”¨æˆ·ç”»åƒæ„å»º</span>
                        </div>
                        <div class="flex items-center">
                            <i class="fas fa-check-circle mr-2 text-green-400"></i>
                            <span>å•†ä¸šæ¨¡å¼è®¾è®¡å»ºè®®</span>
                        </div>
                        <div class="flex items-center">
                            <i class="fas fa-check-circle mr-2 text-green-400"></i>
                            <span>è´¢åŠ¡é¢„æµ‹ä¸å»ºæ¨¡</span>
                        </div>
                        <div class="flex items-center">
                            <i class="fas fa-check-circle mr-2 text-green-400"></i>
                            <span>é£é™©è¯†åˆ«ä¸åº”å¯¹ç­–ç•¥</span>
                        </div>
                        <div class="flex items-center">
                            <i class="fas fa-check-circle mr-2 text-green-400"></i>
                            <span>è¥é”€æ¨å¹¿ç­–ç•¥å»ºè®®</span>
                        </div>
                        <div class="flex items-center">
                            <i class="fas fa-check-circle mr-2 text-green-400"></i>
                            <span>åˆ†é˜¶æ®µå®æ–½è·¯çº¿å›¾</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<script>
// å­—ç¬¦è®¡æ•°
document.getElementById('business_description').addEventListener('input', function() {
    const current = this.value.length;
    const max = this.getAttribute('maxlength');
    document.getElementById('char-count').textContent = current + '/' + max;
});

// è¡¨å•æäº¤å¤„ç†
document.getElementById('report-form').addEventListener('submit', function(e) {
    const submitBtn = document.getElementById('submit-btn');
    const title = document.getElementById('business_title').value.trim();
    const description = document.getElementById('business_description').value.trim();
    
    if (title.length === 0 || description.length < 50) {
        e.preventDefault();
        alert('è¯·ç¡®ä¿é¡¹ç›®æ ‡é¢˜ä¸ä¸ºç©ºï¼Œä¸”æè¿°è‡³å°‘50ä¸ªå­—ç¬¦');
        return;
    }
    
    // ç¦ç”¨æŒ‰é’®å¹¶æ˜¾ç¤ºåŠ è½½çŠ¶æ€
    submitBtn.disabled = true;
    submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>æ­£åœ¨å¤„ç†...';
    
    // é˜²æ­¢å¤šæ¬¡æäº¤
    setTimeout(() => {
        if (!submitBtn.disabled) return;
        submitBtn.disabled = false;
        submitBtn.innerHTML = '<i class="fas fa-rocket mr-2"></i>å¼€å§‹ç”ŸæˆæŠ¥å‘Š';
    }, 10000); // 10ç§’åé‡æ–°å¯ç”¨æŒ‰é’®
});
</script>

<?php
// åŒ…å«å°¾éƒ¨
include __DIR__ . '/includes/footer.php';
?>